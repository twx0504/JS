<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>05-Promise - Resolve & Reject of Executor</title>
  </head>
  <body>
    <script>
      // new Promise((resolve, reject) => {})
      // resolve(value)
      // reject(exception)

      // #1: resolve & reject can change the PromiseState.
      // #2: resolve & reject can accept one argument.
      // - resolve(value) -> the value will be passed as an argument to the first callback of then.
      // - reject(exception) -> the exception will be passed as an argument to the second callback of then.
      const promise = new Promise((resolve, reject) => {
        resolve({ name: "twx", id: "0054" });
      });

      promise.then(
        (data) => {
          console.log(`Success! Data: ${JSON.stringify(data)}`); // Success! Data: {"name":"twx","id":"0054"}
        },
        (err) => {
          console.log(err);
        }
      );

      const promise2 = new Promise((resolve, reject) => {
        reject(new Error("Failed."));
      });

      promise2.then(
        (data) => {
          console.log(`Success! Data: ${JSON.stringify(data)}`);
        },
        (err) => {
          console.log(err); // Error: Failed.
        }
      );

      // #3: resolve & reject can only accept one argument.
      const promise3 = new Promise((resolve, reject) => {
        // Note: resolve & reject can only accept one argument.
        resolve(1, 2, 3);
        // reject(new Error("1", new Error("2")));
      });

      promise3.then(
        (data, data2) => {
          console.log(`Success! Data: ${JSON.stringify(data)}`); // Success! Data: 1
        },
        (err) => {
          console.log(err);
        }
      );

      // Values passed into resolve/reject

      const thenableObj = {
        then(onFulfilled, onRejected) {
          onFulfilled("Success.");
        },
      };

      const promiseA = new Promise((resolve, reject) => {
        // #1: Resolve without passing a value — defaults to resolving with undefined.
        // resolve(); // same as resolve(undefined);

        // #2: Resolve with a normal value.
        // resolve(100);

        // #3: Resolve with a thenable object.
        // JavaScript will call the object's "then" method and follow its behavior.
        // resolve(thenableObj);

        // #4: Resolve with another promise — the outer promise adopts the inner promise's state and result.
        resolve(
          new Promise((resolve, reject) => {
            // If the inner promise is rejected, the outer promise becomes "rejected" with the same reason.
            reject(new Error("100000"));

            // If the inner promise is fulfilled, the outer promise becomes "fulfilled" with the same value.
            // resolve(2000);
          })
        );
      });

      promiseA
        .then((data) => console.log(data))
        .catch((err) => console.log(err));
    </script>
  </body>
</html>
