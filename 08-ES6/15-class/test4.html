<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test 4</title>
  </head>
  <body>
    <script>
      let getMoney;
      class A {
        #money = 2000;
        count = 1000;
        static foo = "foo";
        static {
          console.log(this === A);

          // Share field access with external code.
          // Functions defined inside a class have lexical access to the class's field syntax.
          // Since these are instance fields (not static), they exist on individual instances.
          // In a static block, 'this' refers to the class constructor, not an instance,
          // so we use a parameter 'obj' to represent the instance we'll access later.
          // When called, 'obj' must be an actual instance of this class for private field access to work.

          // In the instance method, we can often write this.#money / this.count because this refers to instance!
          // in static initializatoin block, "this" is no longer an instance.
          // with some tricks, using function and passing instance allows us to expose some of the field for the external code.
          // Of course, we need to pass the instance of this class too.
          getMoney = (obj) => {
            return {
              money: obj.#money, // Private field - requires obj to be instance of A
              count: obj.count, // Public field - works on any object with 'count' property
            };
          };
        }
      }

      class B extends A {
        constructor() {
          super();
        }

        static {
          console.log(super.foo); // refers to the static properties of a super class.
        }
      }

      const a = new A();
      //   class A {
      //     #money = 2000;
      //     count = 1000;
      //     static {
      //       console.log(this);

      //       // Share field access with external code.
      //       // Functions defined inside a class have â€¦

      // By passing an valid instance, we get access to the class field.
      // Because function remembers where it is defined, and have access to anything from there.
      console.log(getMoney(a));
      // {money: 2000, count: 1000}
    </script>
  </body>
</html>
