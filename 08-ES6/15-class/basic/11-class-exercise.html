<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Convert ES6 Class to Pre-Class Constructor Function</title>
  </head>
  <body>
    <script>
      //   class A {
      //     // Static private property to count the number of instances created
      //     static #num = 0;

      //     // Constructor method
      //     constructor(x, y) {
      //       this.x = x;
      //       this.y = y;
      //       A.#num++; // Increment the counter when a new instance is created
      //     }

      //     #count = 5; // Private property

      //     // Getter function
      //     get count() {
      //       return this.#count;
      //     }

      //     // Setter function
      //     set count(value) {
      //       // Processing logic omitted
      //       this.#count = value;
      //     }

      //     // Private method
      //     #Foo() {
      //       return 2;
      //     }

      //     // Instance method
      //     sum() {
      //       console.log(this.x + this.y);
      //     }

      //     // Static method
      //     static children() {
      //       console.log(this.#num);
      //     }

      //     // Instance method
      //     bar() {
      //       console.log(this.#Foo());
      //     }
      //   }

      //   const a1 = new A(1, 2);
      //   const a2 = new A(2, 3);
      //   A.children(); // 2
      //   a1.sum(); // 3
      //   a2.bar(); // 2
      //   a1.count = 6;
      //   console.log(a1.count); // 6

      // ES5
      // var A = (function () {
      //   // implementation of private members with closure.

      //   var _num = 0;

      //   function A(x, y) {
      //     this.x = x;
      //     this.y = y;

      //     this._count = 5;
      //     this._Foo = function () {
      //       return 2;
      //     };
      //     _num++;

      //     Object.defineProperty(this, "count", {
      //       get() {
      //         return this._count;
      //       },
      //       set(val) {
      //         this._count = val;
      //       },
      //     });
      //   }

      //   A.children = function () {
      //     console.log(_num);
      //   };

      //   A.prototype.sum = function () {
      //     console.log(this.x + this.y);
      //   };

      //   A.prototype.bar = function () {
      //     console.log(this._Foo());
      //   };

      //   return A;
      // })();

      // const a1 = new A(1, 2);
      // const a2 = new A(2, 3);
      // A.children();
      // a1.sum();
      // a2.bar();
      // a1.count = 6;
      // console.log(a1.count);

      // Pre-Class

      const A = (function () {
        // #num - static private
        // #count - instance private
        // #Foo - instance private method
        const instancePrivates = new WeakMap();
        // const count = Symbol("count");
        // share static private property
        let _num = 0;
        // Share private instance function
        function _Foo() {
          return 20000;
        }
        function A(x, y) {
          this.x = x;
          this.y = y;
          _num++;
          instancePrivates.set(this, {
            count: 5,
          });
          Object.defineProperty(this, "count", {
            get: function () {
              console.log("get");
              return instancePrivates.get(this).count;
            },
            set: function (val) {
              console.log("set");
              instancePrivates.get(this).count = val;
            },
          });
        }

        A.children = function () {
          console.log(_num);
        };

        A.prototype.bar = function () {
          console.log(_Foo());
        };
        A.prototype.sum = function () {
          console.log(this.x + this.y);
        };

        // getter & setter count
        return A;
      })();

      const a1 = new A(1, 2);
      const a2 = new A(2, 3);
      A.children(); // 2

      a1.count = 10;
      console.log(a1.count);
      console.log(a2.count);
      a1.sum(); // 3
      a2.sum(); // 5
      a1.bar(); // 20000
      a2.bar(); // 20000
    </script>
  </body>
</html>
