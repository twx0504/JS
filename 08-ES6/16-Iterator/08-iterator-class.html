<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      08-Iterator - Stack: Separate the data class from the iterator class
    </title>
  </head>
  <body>
    <script>
      class DataIterator {
        #data;
        #index = 0;
        constructor(data) {
          this.#data = data;
        }

        isDone() {
          // when all the member of a collection have been iterated, it returns true.
          return this.#index >= this.#data.length;
        }

        next() {
          if (!this.isDone()) {
            return {
              value: this.#data[this.#index++],
              done: false,
            };
          } else {
            return {
              value: undefined,
              done: true,
            };
          }
        }
      }

      class DataContainer {
        #data; // private field
        constructor(data = []) {
          if (Array.isArray(data)) {
            this.#data = data;
          } else {
            throw new Error("Data must be an array type.");
          }
        }

        getIterator() {
          //   return {
          //     isDone() {},
          //     next() {
          //       console.log("next");
          //     },
          //   };
          return new DataIterator(this.#data);
        }

        forEach(callback) {
          for (let i = 0; i < this.#data.length; i++) {
            callback(this.#data[i], i, this.#data);
          }
        }
      }

      const data = new DataContainer([1, 2, 3, 4, 5]);
      const iter = data.getIterator();
      console.log(iter);
      console.log(iter.next());
      console.log(iter.next());
      console.log(iter.next());
      console.log(iter.next());
      console.log(iter.next());
      console.log(iter.next());
      //   const data2 = new DataContainer();
      //   const data3 = new DataContainer({a:1});

      class A {
        constructor(data) {
          this.data = data;
        }
        getIterator() {
          //   return {
          //     isDone() {},
          //     next() {
          //       console.log("next");
          //     },
          //   };

          return new DataIterator(this.data);
        }
      }

      const arrLike = { 0: "a", 1: "b", 2: "c", length: 3 };

      //   for (let i = 0; i < arrLike.length; i++) {
      //     console.log(arrLike[i]);
      //   }
      const a = new A(arrLike);
      const iter2 = a.getIterator();
      while (!iter2.isDone()) {
        let obj = iter2.next();
        if (obj.value === "b") {
          break;
        }
        console.log(obj.value);
      }
      console.log(iter2.next());
      //   console.log(iter2);
      //   console.log(iter2.next());
      //   console.log(iter2.next());
      //   console.log(iter2.next());

      const b = new DataContainer([2, 3, 4]);
      b.forEach(function (val) {
        console.log(val);
      });
    </script>
  </body>
</html>
