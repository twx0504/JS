<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>07-Proxy - Set: Data Binding</title>
  </head>
  <body>
    <h3 class="title"></h3>
    <p class="desc"></p>
    <script>
      const data = {
        title: "Old News Title",
        desc: "Old News Description",
      };

      Object.defineProperty(data, "company", {
        value: "Sinchew",
        configurable: false,
        writable: false,
      });

      const h3 = document.querySelector(".title");
      const p = document.querySelector(".desc");
      console.log(h3, p);

      h3.textContent = data.title;
      p.textContent = data.desc;

      const proxy = new Proxy(data, {
        set(target, key, val) {
          target[key] = val; // change the data.
          switch (key) {
            // change the DOM.
            case "title":
              h3.textContent = val;
              break;
            case "desc":
              p.textContent = val;
              break;
          }
          return true;
        },
      });

      // When click the page, change the title and description of the news.
      document.onclick = function () {
        proxy.title = "Breaking News!";
        proxy.desc = "Breaking News Desc!";
        // When the property is both non-writable AND non-configurable, we cannot set its value otherwise an Error is thrown.
        proxy.company = "The Star"; // Uncaught TypeError: 'set' on proxy: trap returned truish for property 'company' which exists in the proxy target as a non-configurable and non-writable data property with a different value
      };
    </script>
  </body>
</html>
