<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      04-Object - Object.getOwnPropertyDescriptor /
      Object.getOwnPropertyDescriptors
    </title>
  </head>
  <body>
    <script>
      // Object.getOwnPropertyDescriptor(obj, prop)
      const obj = {
        name: "twx",
        _gender: "male",
        get gender() {
          return this._gender;
        },
        set gender(v) {
          this._gender = v;
        },
      };

      Object.defineProperty(obj, "x", {
        value: 10,
      });

      const desc1 = Object.getOwnPropertyDescriptor(obj, "name");
      const desc2 = Object.getOwnPropertyDescriptor(obj, "gender");
      const desc3 = Object.getOwnPropertyDescriptor(obj, "x");
      const desc4 = Object.getOwnPropertyDescriptor(obj, "y");
      const desc5 = Object.getOwnPropertyDescriptor(obj, "_gender");
      console.log(desc1); // {value: 'twx', writable: true, enumerable: true, configurable: true}
      console.log(desc2); // {enumerable: true, configurable: true, get: ƒ, set: ƒ}
      // note: accessor property does not have writable and value in its descriptor object.
      console.log(desc3); // {value: 10, writable: false, enumerable: false, configurable: false}
      console.log(desc4); // undefined // note: when the obj doesn't have the property you want to look for.
      console.log(desc5); // {value: 'male', writable: true, enumerable: true, configurable: true}

      //   Object.getOwnPropertyDescriptors(obj)
      const descs = Object.getOwnPropertyDescriptors(obj);
      console.log(descs);
      //   {
      //     name: {
      //       value: "twx",
      //       writable: true,
      //       enumerable: true,
      //       configurable: true,
      //     },
      //     _gender: {
      //       value: "male",
      //       writable: true,
      //       enumerable: true,
      //       configurable: true,
      //     },
      //     gender: { enumerable: true, configurable: true, get: ƒ, set: ƒ },
      //     x: {
      //       value: 10,
      //       writable: false,
      //       enumerable: false,
      //       configurable: false,
      //     },
      //   };

      //   Object.create(proto, propertiesObject)
      // - It solves the problem of Object.assign that converts the accessor property to the data property.
      // - It makes sure the accessor properties is working on the new object created.
      const newObj = Object.create(
        Object.getPrototypeOf(obj), // inherit props from obj's prototype
        descs // add all own enumerable properties to the newObj
      );
      const newObj2 = Object.assign({}, obj);

      console.log(newObj); // {name: 'twx', _gender: 'male', x: 10} // When using Object.create, we can copy accessor property.
      console.log(newObj2); // {name: 'twx', _gender: 'male', gender: 'male'} // Note: the problem of Object.assign is that it cannot copy accessor property.
    </script>
  </body>
</html>
